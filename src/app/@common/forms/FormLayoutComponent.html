<div style="position: relative;" class="mat-elevation-z8 p-24">
    <form
        class="form-horizontal"
        [formGroup]="FormComponent.Form.FormGroup"
        *ngIf="FormComponent.formLoaded"
    >
        <mat-tab-group>
            <mat-tab label="Основное">
                <div class="p-12"><ng-content></ng-content></div>
            </mat-tab>
            <mat-tab
                *ngFor="let propertiesSet of FormComponent.ModelProperties"
                [label]="propertiesSet.Name"
            >
                <div class="p-12" *ngFor="let prop of propertiesSet.Properties">
                    <div [ngSwitch]="prop.Type">
                        <div *ngSwitchCase="FormComponent.PropertiesElementTypes.Dropdown">
                            <autocomplete-input
                                [FormGroup]="FormComponent.Form.FormGroup"
                                FieldName="{{ propertiesSet.Key + prop.Key }}"
                                [Options]="
                                    FormComponent.PropertiesOptions(propertiesSet.Key, prop.Key)
                                "
                                TitleField="Title"
                                GroupField="Group"
                                ValueField="Value"
                                Label="{{ prop.Name }}"
                            ></autocomplete-input>
                        </div>
                        <div *ngSwitchCase="FormComponent.PropertiesElementTypes.String">
                            <text-input
                                [FormGroup]="FormComponent.Form.FormGroup"
                                FieldName="{{ propertiesSet.Key + prop.Key }}"
                                Label="{{ prop.Name }}"
                            ></text-input>
                        </div>
                        <div *ngSwitchCase="FormComponent.PropertiesElementTypes.PasswordString">
                            <text-input
                                [FormGroup]="FormComponent.Form.FormGroup"
                                Type="password"
                                FieldName="{{ propertiesSet.Key + prop.Key }}"
                                Label="{{ prop.Name }}"
                            ></text-input>
                        </div>
                        <div *ngSwitchCase="FormComponent.PropertiesElementTypes.LongString">
                            <textarea-input
                                [FormGroup]="FormComponent.Form.FormGroup"
                                FieldName="{{ propertiesSet.Key + prop.Key }}"
                                Label="{{ prop.Name }}"
                            ></textarea-input>
                        </div>
                        <div *ngSwitchCase="FormComponent.PropertiesElementTypes.Url">
                            <text-input
                                [FormGroup]="FormComponent.Form.FormGroup"
                                Type="url"
                                FieldName="{{ propertiesSet.Key + prop.Key }}"
                                Label="{{ prop.Name }}"
                            ></text-input>
                        </div>
                        <div *ngSwitchCase="FormComponent.PropertiesElementTypes.Checkbox">
                            <checkbox-input
                                [FormGroup]="FormComponent.Form.FormGroup"
                                FieldName="{{ propertiesSet.Key + prop.Key }}"
                                Label="{{ prop.Name }}"
                            ></checkbox-input>
                        </div>
                        <div *ngSwitchDefault>Unknown field</div>
                    </div>
                </div>
            </mat-tab>
            <mat-tab label="<>">
                <pre>
          {{ FormComponent.model | json }}
            </pre
                >
            </mat-tab>
        </mat-tab-group>
        <div class="p-12">
            <button
                mat-raised-button
                color="primary"
                type="submit"
                (click)="save()"
                [ngClass]="{
                    invalid: FormComponent.Form.FormGroup.invalid,
                    'no-changes': !FormComponent.Form.hasChanges
                }"
                [disabled]="
                    FormComponent.Form.FormGroup.invalid ||
                    !FormComponent.Form.hasChanges ||
                    FormComponent.Form.inProgress
                "
            >
                Сохранить
            </button>

            <button
                mat-raised-button
                color="accent"
                (click)="FormComponent.changePublishState()"
                *ngIf="!FormComponent.model.IsPublished"
                [disabled]="
                    FormComponent.Form.FormGroup.invalid ||
                    FormComponent.Form.hasChanges ||
                    FormComponent.Form.inProgress
                "
            >
                Опубликовать
            </button>
            <button
                mat-raised-button
                color="warn"
                (click)="FormComponent.changePublishState()"
                *ngIf="FormComponent.model.IsPublished"
                [disabled]="
                    FormComponent.Form.FormGroup.invalid ||
                    FormComponent.Form.hasChanges ||
                    FormComponent.Form.inProgress
                "
            >
                Спрятать
            </button>
        </div>
    </form>
</div>
