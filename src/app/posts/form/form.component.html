<div class="page-layout blank p-24">
    <form-layout *ngIf="formLoaded" [FormComponent]="this">
        <text-input
            [FormGroup]="FormGroup"
            FieldName="Title"
            Label="Название"
        ></text-input>
        <text-input
            [FormGroup]="FormGroup"
            FieldName="Url"
            Label="Адрес на сайте"
        ></text-input>
        <chips-input
            [FormGroup]="FormGroup"
            FieldName="SectionIds"
            Label="Разделы"
            TitleField="Title"
            ValueField="Id"
            [Options]="Sections"
        ></chips-input>
        <chips-input
            [FormGroup]="FormGroup"
            FieldName="TagIds"
            Label="Тэги"
            TitleField="Name"
            ValueField="Id"
            [Creatable]="true"
            [EntitiesService]="servicesProvider.TagsService"
            [Options]="Tags"
        ></chips-input>
        <div class="blocks" cdkDropList (cdkDropListDropped)="drop($event)">
            <div
                *ngFor="let block of model.Blocks"
                [ngSwitch]="block.Type"
                class="blockElement"
                cdkDrag
            >
                <div class="delete" (click)="deleteBlock(block)">
                    <mat-icon>delete</mat-icon>
                </div>
                <ng-container *ngSwitchCase="BlockTypes.Text">
                    <text-block-form
                        [postFormComponent]="this"
                        [FormGroup]="FormGroup"
                        [Model]="block"
                    ></text-block-form>
                </ng-container>
                <ng-container *ngSwitchCase="BlockTypes.Gallery">
                    <gallery-block-form
                        [postFormComponent]="this"
                        [FormGroup]="FormGroup"
                        [Model]="block"
                    ></gallery-block-form>
                </ng-container>
                <ng-container *ngSwitchCase="BlockTypes.File">
                    <file-block-form
                        [postFormComponent]="this"
                        [FormGroup]="FormGroup"
                        [Model]="block"
                    ></file-block-form>
                </ng-container>
            </div>
        </div>
        <button mat-icon-button [matMenuTriggerFor]="menu">
            Добавить блок
        </button>
        <mat-menu #menu="matMenu">
            <button mat-menu-item (click)="addBlock(BlockTypes.Text)">
                <mat-icon>import_contacts</mat-icon>
                <span>Текст</span>
            </button>
            <button mat-menu-item (click)="addBlock(BlockTypes.Gallery)">
                <mat-icon>images</mat-icon>
                <span>Галерея</span>
            </button>
            <button mat-menu-item (click)="addBlock(BlockTypes.File)">
                <mat-icon>attachment</mat-icon>
                <span>Файл</span>
            </button>
        </mat-menu>
    </form-layout>
</div>
